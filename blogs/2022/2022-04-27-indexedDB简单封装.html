<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>对indexedDB的简单封装 | 红尘散仙</title>
    <meta name="generator" content="VuePress 1.7.1">
    <script>
          var _hmt = _hmt || [];
          (function() {
            var hm = document.createElement("script");
            hm.src = "https://hm.baidu.com/hm.js?b0aae218897fa9d8a9f76e9a77e0b3c6";
            var s = document.getElementsByTagName("script")[0]; 
            s.parentNode.insertBefore(hm, s);
          })();
        </script>
    <meta name="description" content="心软不是病，回头才致命">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    
    <link rel="preload" href="/assets/css/0.styles.e0c65345.css" as="style"><link rel="preload" href="/assets/js/app.263edb86.js" as="script"><link rel="preload" href="/assets/js/5.41e71567.js" as="script"><link rel="preload" href="/assets/js/1.0885ffa2.js" as="script"><link rel="preload" href="/assets/js/20.98d10011.js" as="script"><link rel="prefetch" href="/assets/js/10.5cacfa0c.js"><link rel="prefetch" href="/assets/js/11.d120a05a.js"><link rel="prefetch" href="/assets/js/12.81e07b7c.js"><link rel="prefetch" href="/assets/js/13.4bdd887f.js"><link rel="prefetch" href="/assets/js/14.a3eab8e3.js"><link rel="prefetch" href="/assets/js/15.4710481f.js"><link rel="prefetch" href="/assets/js/16.cd86f7af.js"><link rel="prefetch" href="/assets/js/17.b2128cc4.js"><link rel="prefetch" href="/assets/js/18.4f49df16.js"><link rel="prefetch" href="/assets/js/19.8508c52b.js"><link rel="prefetch" href="/assets/js/21.239525e4.js"><link rel="prefetch" href="/assets/js/22.6dfa2a44.js"><link rel="prefetch" href="/assets/js/23.ec189a87.js"><link rel="prefetch" href="/assets/js/24.7dc1e52f.js"><link rel="prefetch" href="/assets/js/25.29e59e1f.js"><link rel="prefetch" href="/assets/js/26.73274a61.js"><link rel="prefetch" href="/assets/js/3.ba2d341d.js"><link rel="prefetch" href="/assets/js/4.fe07d8e5.js"><link rel="prefetch" href="/assets/js/6.7d58b05c.js"><link rel="prefetch" href="/assets/js/7.5f1b2659.js"><link rel="prefetch" href="/assets/js/8.6af564f0.js"><link rel="prefetch" href="/assets/js/9.39ad1473.js">
    <link rel="stylesheet" href="/assets/css/0.styles.e0c65345.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar" data-v-eb9dde9c><div data-v-eb9dde9c><div id="loader-wrapper" class="loading-wrapper" data-v-d48f4d20 data-v-eb9dde9c data-v-eb9dde9c><div class="loader-main" data-v-d48f4d20><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div></div> <!----> <!----></div> <div class="password-shadow password-wrapper-out" style="display:none;" data-v-5cb9a64e data-v-eb9dde9c data-v-eb9dde9c><h3 class="title" style="display:none;" data-v-5cb9a64e data-v-5cb9a64e>红尘散仙</h3> <!----> <label id="box" class="inputBox" style="display:none;" data-v-5cb9a64e data-v-5cb9a64e><input type="password" value="" data-v-5cb9a64e> <span data-v-5cb9a64e>Konck! Knock!</span> <button data-v-5cb9a64e>OK</button></label> <div class="footer" style="display:none;" data-v-5cb9a64e data-v-5cb9a64e><span data-v-5cb9a64e><i class="iconfont reco-theme" data-v-5cb9a64e></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-5cb9a64e>vuePress-theme-reco</a></span> <span data-v-5cb9a64e><i class="iconfont reco-copyright" data-v-5cb9a64e></i> <a data-v-5cb9a64e><span data-v-5cb9a64e>红尘散仙</span>
            
          <!---->
          2022
        </a></span></div></div> <div class="hide" data-v-eb9dde9c><div data-v-eb9dde9c><div id="smart" class="wrapper-page" style="background-image:url(/images/2053194.jpg);background-position-x:center;background-position-y:center;background-size:cover;background-repeat-x:no-repeat;background-repeat-y:no-repeat;" data-v-eb9dde9c><header class="navbar" data-v-eb9dde9c><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/logo.png" alt="红尘散仙" class="logo"> <span class="site-name">红尘散仙</span></a> <div class="links"><div id="dayNightSwitch" class="generalWrapper" data-v-32f44868><a class="click" data-v-32f44868><div class="onOff daySwitch" data-v-32f44868><div class="star star1" data-v-32f44868></div> <div class="star star2" data-v-32f44868></div> <div class="star star3" data-v-32f44868></div> <div class="star star4" data-v-32f44868></div> <div class="star star5" data-v-32f44868></div> <div class="star sky" data-v-32f44868></div> <div class="sunMoon" data-v-32f44868><div class="crater crater1" data-v-32f44868></div> <div class="crater crater2" data-v-32f44868></div> <div class="crater crater3" data-v-32f44868></div> <div class="cloud part1" data-v-32f44868></div> <div class="cloud part2" data-v-32f44868></div></div></div></a></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link"><i class="iconfont reco-home"></i>
  主页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      博客
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/练习项目/" class="nav-link"><i class="iconfont undefined"></i>
  练习项目
</a></li><li class="dropdown-item"><!----> <a href="/categories/学习笔记/" class="nav-link"><i class="iconfont undefined"></i>
  学习笔记
</a></li><li class="dropdown-item"><!----> <a href="/categories/浅浅探索/" class="nav-link"><i class="iconfont undefined"></i>
  浅浅探索
</a></li></ul></div></div><div class="nav-item"><a href="/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  标签
</a></div><div class="nav-item"><a href="/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  时间轴
</a></div><div class="nav-item"><a href="/about/" class="nav-link"><i class="iconfont reco-account"></i>
  关于
</a></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-eb9dde9c></div> <aside class="sidebar" data-v-eb9dde9c><div class="personal-info-wrapper" data-v-03833281 data-v-eb9dde9c><img src="/avatar-top.png" alt="author-avatar" class="personal-img" data-v-03833281> <h3 class="name" data-v-03833281>
    红尘散仙
  </h3> <div class="num" data-v-03833281><div data-v-03833281><h3 data-v-03833281>13</h3> <h6 data-v-03833281>文章</h6></div> <div data-v-03833281><h3 data-v-03833281>10</h3> <h6 data-v-03833281>标签</h6></div></div> <hr data-v-03833281></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link"><i class="iconfont reco-home"></i>
  主页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      博客
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/练习项目/" class="nav-link"><i class="iconfont undefined"></i>
  练习项目
</a></li><li class="dropdown-item"><!----> <a href="/categories/学习笔记/" class="nav-link"><i class="iconfont undefined"></i>
  学习笔记
</a></li><li class="dropdown-item"><!----> <a href="/categories/浅浅探索/" class="nav-link"><i class="iconfont undefined"></i>
  浅浅探索
</a></li></ul></div></div><div class="nav-item"><a href="/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  标签
</a></div><div class="nav-item"><a href="/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  时间轴
</a></div><div class="nav-item"><a href="/about/" class="nav-link"><i class="iconfont reco-account"></i>
  关于
</a></div> <!----></nav> <!----> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-5cb9a64e data-v-eb9dde9c><h3 class="title" style="display:none;" data-v-5cb9a64e data-v-5cb9a64e>对indexedDB的简单封装</h3> <!----> <label id="box" class="inputBox" style="display:none;" data-v-5cb9a64e data-v-5cb9a64e><input type="password" value="" data-v-5cb9a64e> <span data-v-5cb9a64e>Konck! Knock!</span> <button data-v-5cb9a64e>OK</button></label> <div class="footer" style="display:none;" data-v-5cb9a64e data-v-5cb9a64e><span data-v-5cb9a64e><i class="iconfont reco-theme" data-v-5cb9a64e></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-5cb9a64e>vuePress-theme-reco</a></span> <span data-v-5cb9a64e><i class="iconfont reco-copyright" data-v-5cb9a64e></i> <a data-v-5cb9a64e><span data-v-5cb9a64e>红尘散仙</span>
            
          <!---->
          2022
        </a></span></div></div></div> <div data-v-eb9dde9c><main class="page" style="padding-right:0;"><div class="page-title" style="display:none;"><h1 class="title">对indexedDB的简单封装</h1> <div class="page-info" data-v-0efa1f05><i class="iconfont reco-account" data-v-0efa1f05><span data-v-0efa1f05>红尘散仙</span></i> <i class="iconfont reco-date" data-v-0efa1f05><span data-v-0efa1f05>2022-04-27</span></i> <i class="iconfont reco-eye" data-v-0efa1f05><span id="/blogs/2022/2022-04-27-indexedDB%E7%AE%80%E5%8D%95%E5%B0%81%E8%A3%85.html" data-flag-title="Your Article Title" class="leancloud-visitors" data-v-0efa1f05><a class="leancloud-visitors-count" style="font-size:.9rem;font-weight:normal;color:#999;"></a></span></i> <i class="iconfont reco-tag tags" data-v-0efa1f05><span class="tag-item" data-v-0efa1f05>indexedDB</span><span class="tag-item" data-v-0efa1f05>javascript</span></i></div></div> <div class="theme-reco-content content__default" style="display:none;"><div class="custom-block tip"><p class="custom-block-title">介绍</p> <p>基于promise对indexedDB的简单封装</p></div> <h1 id="idbclass"><a href="#idbclass" class="header-anchor">#</a> IDBClass</h1> <p><strong>基于promise对indexedDB的简单封装</strong></p> <h2 id="一-背景"><a href="#一-背景" class="header-anchor">#</a> 一.背景</h2> <p>最近在阮一峰的日记里无意间浏览到了indexedDB,标准的客户端存储技术。IndexedDB 是一个基于 JavaScript 的面向对象数据库。IndexedDB 允许您存储和检索用<strong>键</strong>索引的对象；</p> <h3 id="官方介绍"><a href="#官方介绍" class="header-anchor">#</a> 官方介绍</h3> <p>IndexedDB 是一种底层 API，用于在客户端存储大量的结构化数据（也包括文件/二进制大型对象（blobs））。该 API 使用索引实现对数据的高性能搜索。虽然 <a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Web_Storage_API" target="_blank" rel="noopener noreferrer">Web Storage<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 在存储较少量的数据很有用，但对于存储更大量的结构化数据来说力不从心。而 IndexedDB 提供了这种场景的解决方案。本页面 MDN IndexedDB 的主要引导页 - 这里，我们提供了完整的 API 参考和使用指南，浏览器支持细节，以及关键概念的一些解释的链接。</p> <p><strong>Note:</strong> 此特性在 <a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Web_Workers_API" target="_blank" rel="noopener noreferrer">Web Worker<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 中可用</p> <p><strong>注意</strong>：IndexedDB API是强大的，但对于简单的情况可能看起来太复杂。如果你更喜欢一个简单的API，请尝试  <a href="https://localforage.github.io/localForage/" target="_blank" rel="noopener noreferrer">localForage<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>、<a href="https://www.dexie.org/" target="_blank" rel="noopener noreferrer">dexie.js<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>、<a href="https://pouchdb.com/" target="_blank" rel="noopener noreferrer">PouchDB<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>、<a href="https://www.npmjs.com/package/idb" target="_blank" rel="noopener noreferrer">idb<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>、<a href="https://www.npmjs.com/package/idb-keyval" target="_blank" rel="noopener noreferrer">idb-keyval<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>、<a href="https://jsstore.net/" target="_blank" rel="noopener noreferrer">JsStore<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 或者 <a href="https://github.com/google/lovefield" target="_blank" rel="noopener noreferrer">lovefield<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 之类的库，这些库使 IndexedDB 对开发者来说更加友好。</p> <h3 id="产生原因"><a href="#产生原因" class="header-anchor">#</a> 产生原因</h3> <p>indexedDB的方法都是异步的，得去成功的回调去拿值，用起来不是很方便，所以打算自己封装一下indexedDB的常用操作，目前只有class版本的。</p> <h2 id="二-使用方式"><a href="#二-使用方式" class="header-anchor">#</a> 二.使用方式</h2> <p>导入模块</p> <h3 id="_1-初始化"><a href="#_1-初始化" class="header-anchor">#</a> 1.初始化</h3> <table><thead><tr><th>optionsName</th> <th>value</th></tr></thead> <tbody><tr><td>databaseName</td> <td>数据库名称</td></tr> <tr><td>version</td> <td>版本</td></tr> <tr><td>objectStores</td> <td>想要创建的对象仓库</td></tr> <tr><td>objectStoreName</td> <td>仓库名称</td></tr> <tr><td>objectStoreOptions</td> <td>仓库选项</td></tr> <tr><td>objectStoreIndex</td> <td>创建索引</td></tr></tbody></table> <div class="language-typescript extra-class"><pre class="language-typescript"><code>onst database <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">IDBClass</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      databaseName<span class="token operator">:</span> <span class="token string">'test'</span><span class="token punctuation">,</span>
      version<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
      objectStores<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
        objectStoreName<span class="token operator">:</span> <span class="token string">'test'</span><span class="token punctuation">,</span>
        objectStoreOptions<span class="token operator">:</span> <span class="token punctuation">{</span>
          keyPath<span class="token operator">:</span> <span class="token string">'id'</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        objectStoreIndex<span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">'name'</span><span class="token punctuation">,</span> keyPath<span class="token operator">:</span> <span class="token string">'name'</span><span class="token punctuation">,</span> options<span class="token operator">:</span> <span class="token punctuation">{</span> unique<span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">'email'</span><span class="token punctuation">,</span> keyPath<span class="token operator">:</span> <span class="token string">'email'</span><span class="token punctuation">,</span> options<span class="token operator">:</span> <span class="token punctuation">{</span> unique<span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        objectStoreName<span class="token operator">:</span> <span class="token string">'person'</span><span class="token punctuation">,</span>
        objectStoreOptions<span class="token operator">:</span> <span class="token punctuation">{</span>
          keyPath<span class="token operator">:</span> <span class="token string">'id'</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        objectStoreIndex<span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">'name'</span><span class="token punctuation">,</span> keyPath<span class="token operator">:</span> <span class="token string">'name'</span><span class="token punctuation">,</span> options<span class="token operator">:</span> <span class="token punctuation">{</span> unique<span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">'email'</span><span class="token punctuation">,</span> keyPath<span class="token operator">:</span> <span class="token string">'email'</span><span class="token punctuation">,</span> options<span class="token operator">:</span> <span class="token punctuation">{</span> unique<span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="_2-使用方法进行操作"><a href="#_2-使用方法进行操作" class="header-anchor">#</a> 2.使用方法进行操作</h3> <p>为了简单点，我使用了typedoc注释文档生成</p> <p>github仓库链接<a href="https://github.com/yexiyue/IDBClass" target="_blank" rel="noopener noreferrer">yexiyue/IDBClass: 对indexedDB的简单封装 (github.com)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>下载文件后打开docs/index.html就能看到完整的api详情</p> <div class="language-tsx extra-class"><pre class="language-tsx"><code> database<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token string">'person'</span><span class="token punctuation">,</span><span class="token string">'张三'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span>e<span class="token operator">=&gt;</span><span class="token punctuation">{</span><span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">*</span><span class="token operator">/</span>
 database<span class="token punctuation">.</span><span class="token function">findAll</span><span class="token punctuation">(</span><span class="token string">'person'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>e<span class="token operator">=&gt;</span><span class="token punctuation">{</span>
      <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
      <span class="token keyword">return</span> database<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'person'</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>e<span class="token operator">=&gt;</span><span class="token punctuation">{</span>
      <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    database<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'person'</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>e<span class="token operator">=&gt;</span><span class="token punctuation">{</span>
      <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
      <span class="token keyword">return</span> database<span class="token punctuation">.</span><span class="token function">getByIndex</span><span class="token punctuation">(</span><span class="token string">'person'</span><span class="token punctuation">,</span><span class="token string">'name'</span><span class="token punctuation">,</span><span class="token string">'yehsifu'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>e<span class="token operator">=&gt;</span><span class="token punctuation">{</span>
      <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
      <span class="token keyword">return</span> database<span class="token punctuation">.</span><span class="token function">findByIndex</span><span class="token punctuation">(</span><span class="token string">'person'</span><span class="token punctuation">,</span><span class="token string">'name'</span><span class="token punctuation">,</span><span class="token string">'yehsifu'</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>e<span class="token operator">=&gt;</span><span class="token punctuation">{</span>
      <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
      
    <span class="token punctuation">}</span><span class="token punctuation">)</span> 
   database<span class="token punctuation">.</span><span class="token function">getByIndexCursor</span><span class="token punctuation">(</span><span class="token string">'person'</span><span class="token punctuation">,</span><span class="token string">'name'</span><span class="token punctuation">,</span><span class="token string">'yehsifu'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>e<span class="token operator">=&gt;</span><span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">)</span>
    database<span class="token punctuation">.</span><span class="token function">PageByIndexCursor</span><span class="token punctuation">(</span><span class="token string">'person'</span><span class="token punctuation">,</span><span class="token string">'name'</span><span class="token punctuation">,</span><span class="token string">'yehsifu'</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>e<span class="token operator">=&gt;</span><span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">)</span> 
   database<span class="token punctuation">.</span><span class="token function">page</span><span class="token punctuation">(</span><span class="token string">'person'</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>e<span class="token operator">=&gt;</span><span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">)</span> 

   database<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">'person'</span><span class="token punctuation">,</span><span class="token punctuation">{</span>id<span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span>name<span class="token operator">:</span><span class="token string">'yeshifu666'</span><span class="token punctuation">,</span>email<span class="token operator">:</span><span class="token string">'5f4ghf5h'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
   database<span class="token punctuation">.</span><span class="token function">putByIndexCursor</span><span class="token punctuation">(</span><span class="token string">'person'</span><span class="token punctuation">,</span><span class="token string">'email'</span><span class="token punctuation">,</span><span class="token string">'6666666'</span><span class="token punctuation">,</span><span class="token punctuation">{</span>email<span class="token operator">:</span><span class="token string">'88888'</span><span class="token punctuation">,</span>name<span class="token operator">:</span><span class="token string">'6到家了'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>e<span class="token operator">=&gt;</span><span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">)</span> 

  database<span class="token punctuation">.</span><span class="token function">deleteByIndex</span><span class="token punctuation">(</span><span class="token string">'person'</span><span class="token punctuation">,</span><span class="token string">'email'</span><span class="token punctuation">,</span><span class="token string">'6666666'</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">)</span> 

database<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

database<span class="token punctuation">.</span><span class="token function">deleteDb</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 
</code></pre></div><p>操作结果，部分的，完整的我就懒得截图了自己可以去尝试尝试</p> <p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2e2d8a25571e4d29ba3ad3b244fb1a33~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20220427215027874"></p> <p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d975cfffbe304df886575cb81c4733d1~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20220427214514262"></p> <p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/bf8323fee65446f5afe830b56d71cb8a~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20220427214541061"></p> <p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/727f99a223014a48912d97bc2c9e5fb7~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20220427214622413"></p> <h2 id="三-废话不多说-直接上源码"><a href="#三-废话不多说-直接上源码" class="header-anchor">#</a> 三.废话不多说，直接上源码</h2> <div class="language-typescript extra-class"><pre class="language-typescript"><code>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">IDBClass</span> <span class="token punctuation">{</span>
  <span class="token keyword">public</span> o<span class="token operator">:</span>Options<span class="token punctuation">;</span>
  
  <span class="token function">constructor</span><span class="token punctuation">(</span>o<span class="token operator">:</span>Options<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>o<span class="token operator">=</span>o
    <span class="token comment">//先调用一下生成仓库对象</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getDb</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  
  <span class="token comment">/**
   * @async
   * @returns IDBDatabase
   * @description 异步方法，用来获取数据库
   */</span>
  <span class="token keyword">public</span> <span class="token keyword">async</span> <span class="token function">getDb</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span><span class="token builtin">Promise</span><span class="token operator">&lt;</span>IDBDatabase<span class="token operator">&gt;</span><span class="token punctuation">{</span>
    <span class="token keyword">const</span> openRequest<span class="token operator">:</span>IDBRequest<span class="token operator">=</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token builtin">Promise</span></span><span class="token punctuation">(</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span>reject<span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
      <span class="token keyword">let</span> db<span class="token operator">:</span>IDBDatabase<span class="token punctuation">;</span>
      openRequest<span class="token punctuation">.</span><span class="token function-variable function">onupgradeneeded</span><span class="token operator">=</span><span class="token punctuation">(</span>ev<span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        db<span class="token operator">=</span>ev<span class="token punctuation">.</span>target<span class="token operator">!</span><span class="token punctuation">.</span>result
        <span class="token keyword">if</span><span class="token punctuation">(</span>db<span class="token punctuation">.</span>version<span class="token punctuation">)</span><span class="token punctuation">{</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span>o<span class="token punctuation">.</span>objectStores<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>v<span class="token operator">=&gt;</span><span class="token punctuation">{</span>
            <span class="token keyword">const</span> objectStore<span class="token operator">:</span>IDBObjectStore<span class="token operator">=</span>db<span class="token punctuation">.</span><span class="token function">createObjectStore</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span>objectStoreName<span class="token punctuation">,</span>v<span class="token punctuation">.</span>objectStoreOptions<span class="token punctuation">)</span>
            v<span class="token punctuation">.</span>objectStoreIndex<span class="token operator">?.</span><span class="token function">forEach</span><span class="token punctuation">(</span>v<span class="token operator">=&gt;</span><span class="token punctuation">{</span>
              objectStore<span class="token punctuation">.</span><span class="token function">createIndex</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span>name<span class="token punctuation">,</span>v<span class="token punctuation">.</span>keyPath<span class="token punctuation">,</span>v<span class="token punctuation">.</span>options<span class="token punctuation">)</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
      openRequest<span class="token punctuation">.</span><span class="token function-variable function">onsuccess</span><span class="token operator">=</span><span class="token punctuation">(</span>ev<span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>ev<span class="token punctuation">.</span>target<span class="token operator">!</span><span class="token punctuation">.</span>result<span class="token punctuation">)</span><span class="token punctuation">{</span>
          db<span class="token operator">=</span>ev<span class="token punctuation">.</span>target<span class="token operator">!</span><span class="token punctuation">.</span>result
        <span class="token punctuation">}</span>
        <span class="token function">resolve</span><span class="token punctuation">(</span>db<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
      openRequest<span class="token punctuation">.</span><span class="token function-variable function">onerror</span><span class="token operator">=</span><span class="token punctuation">(</span>ev<span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        <span class="token function">reject</span><span class="token punctuation">(</span><span class="token string">'数据库连接失败'</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token comment">/**
   * 
   * @returns IDBRequest
   * @description 同步方法,用来获取数据库连接请求
   */</span>
  <span class="token keyword">public</span> <span class="token function">getRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span>IDBRequest<span class="token punctuation">{</span>
    <span class="token keyword">let</span> indexedDB<span class="token operator">:</span> IDBFactory <span class="token operator">=</span>window<span class="token punctuation">.</span>indexedDB <span class="token comment">/* ((window as any).indexedDB =
        (window as any).indexedDB ||
        (window as any).mozIndexedDB ||
        (window as any).webkitIndexedDB ||
        (window as any).msIndexedDB); */</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>indexedDB<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'你的浏览器不支持indexedDB'</span><span class="token punctuation">)</span>
        <span class="token keyword">throw</span> <span class="token function">Error</span><span class="token punctuation">(</span><span class="token string">'你的客户端不支持indexedDB'</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token keyword">return</span> indexedDB<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>o<span class="token punctuation">.</span>databaseName<span class="token punctuation">,</span><span class="token keyword">this</span><span class="token punctuation">.</span>o<span class="token punctuation">.</span>version<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token comment">/**
   * @async
   * @param StoreNames 仓库名，或仓库名数组
   * @returns IDBObjectStore or IDBObjectStore[]
   * @description 获取事务objectStore
   */</span>
  <span class="token keyword">public</span> <span class="token keyword">async</span> <span class="token function">getObjectStores</span><span class="token punctuation">(</span>StoreNames<span class="token operator">:</span><span class="token builtin">string</span> <span class="token operator">|</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">:</span><span class="token builtin">Promise</span><span class="token operator">&lt;</span>IDBObjectStore<span class="token operator">|</span><span class="token builtin">any</span><span class="token operator">&gt;</span><span class="token punctuation">{</span>
    <span class="token keyword">const</span> db<span class="token operator">=</span><span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getDb</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token builtin">Promise</span></span><span class="token punctuation">(</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span>reject<span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
      <span class="token keyword">let</span> objectStores<span class="token operator">:</span><span class="token builtin">any</span><span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token keyword">let</span> objectStoreNameList<span class="token operator">=</span><span class="token keyword">this</span><span class="token punctuation">.</span>o<span class="token punctuation">.</span>objectStores<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>v<span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> v<span class="token punctuation">.</span>objectStoreName
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token keyword">const</span> transaction<span class="token operator">:</span>IDBTransaction<span class="token operator">=</span>db<span class="token punctuation">.</span><span class="token function">transaction</span><span class="token punctuation">(</span>objectStoreNameList<span class="token punctuation">,</span><span class="token string">'readwrite'</span><span class="token punctuation">)</span>

      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> StoreNames<span class="token operator">==</span><span class="token string">'string'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        objectStores<span class="token operator">=</span>transaction<span class="token punctuation">.</span><span class="token function">objectStore</span><span class="token punctuation">(</span>StoreNames<span class="token punctuation">)</span>
        <span class="token function">resolve</span><span class="token punctuation">(</span>objectStores<span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
        StoreNames<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span>v<span class="token operator">:</span><span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
          objectStores<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token operator">=</span>transaction<span class="token punctuation">.</span><span class="token function">objectStore</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token function">resolve</span><span class="token punctuation">(</span>objectStores<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token comment">/**
   * @async
   * @param storeName 仓库名
   * @param data 添加的数据对象
   * @returns Boolean
   * @description 用来添加单个数据
   */</span>
  <span class="token keyword">public</span> <span class="token keyword">async</span> <span class="token function">add</span><span class="token punctuation">(</span>storeName<span class="token operator">:</span><span class="token builtin">string</span><span class="token punctuation">,</span>data<span class="token operator">:</span><span class="token builtin">any</span><span class="token punctuation">)</span><span class="token operator">:</span><span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token builtin">boolean</span><span class="token operator">&gt;</span><span class="token punctuation">{</span>
    <span class="token keyword">const</span> objectStores<span class="token operator">:</span>IDBObjectStore<span class="token operator">=</span><span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getObjectStores</span><span class="token punctuation">(</span>storeName<span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token builtin">Promise</span></span><span class="token punctuation">(</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span>reject<span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
      <span class="token keyword">const</span> request<span class="token operator">=</span>objectStores<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
      request<span class="token punctuation">.</span><span class="token function-variable function">onerror</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token function">reject</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>
      request<span class="token punctuation">.</span><span class="token function-variable function">onsuccess</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token comment">/**
   * @async
   * @param storeName 仓库名
   * @param data 添加的数据对象数组
   * @returns Boolean
   * @description 批量添加数据
   */</span>
  <span class="token keyword">public</span> <span class="token keyword">async</span> <span class="token function">addMany</span><span class="token punctuation">(</span>storeName<span class="token operator">:</span><span class="token builtin">string</span><span class="token punctuation">,</span>data<span class="token operator">:</span><span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">:</span><span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token builtin">boolean</span><span class="token operator">&gt;</span><span class="token punctuation">{</span>
    <span class="token keyword">const</span> objectStores<span class="token operator">:</span>IDBObjectStore<span class="token operator">=</span><span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getObjectStores</span><span class="token punctuation">(</span>storeName<span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token builtin">Promise</span></span><span class="token punctuation">(</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span>reject<span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
      data<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>v<span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        <span class="token keyword">const</span> request<span class="token operator">=</span>objectStores<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span>
        request<span class="token punctuation">.</span><span class="token function-variable function">onerror</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token function">reject</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>
        request<span class="token punctuation">.</span><span class="token function-variable function">onsuccess</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token comment">/**
   * @async
   * @param storeName 仓库名
   * @param key 主键值
   * @returns 数据对象
   * @description 通过主键查找
   */</span>
  <span class="token keyword">public</span> <span class="token keyword">async</span> <span class="token function">get</span><span class="token punctuation">(</span>storeName<span class="token operator">:</span><span class="token builtin">string</span><span class="token punctuation">,</span>key<span class="token operator">:</span><span class="token builtin">any</span><span class="token punctuation">)</span><span class="token operator">:</span><span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token builtin">boolean</span><span class="token operator">|</span>object<span class="token operator">&gt;</span><span class="token punctuation">{</span>
    <span class="token keyword">const</span> objectStores<span class="token operator">:</span>IDBObjectStore<span class="token operator">=</span><span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getObjectStores</span><span class="token punctuation">(</span>storeName<span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token builtin">Promise</span></span><span class="token punctuation">(</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span>reject<span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
      <span class="token keyword">const</span> request<span class="token operator">=</span>objectStores<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span>
      request<span class="token punctuation">.</span><span class="token function-variable function">onerror</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token function">reject</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>
      request<span class="token punctuation">.</span><span class="token function-variable function">onsuccess</span><span class="token operator">=</span><span class="token punctuation">(</span>ev<span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token function">resolve</span><span class="token punctuation">(</span>ev<span class="token punctuation">.</span>target<span class="token operator">?.</span>result<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token comment">/**
   * @async
   * @param storeName 仓库名
   * @returns Promise&lt;boolean|object[]&gt;
   * @description 获取当前仓库全部数据
   */</span>
  <span class="token keyword">public</span> <span class="token keyword">async</span> <span class="token function">findAll</span><span class="token punctuation">(</span>storeName<span class="token operator">:</span><span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span><span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token builtin">boolean</span><span class="token operator">|</span>object<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token punctuation">{</span>
    <span class="token keyword">const</span> objectStores<span class="token operator">:</span>IDBObjectStore<span class="token operator">=</span><span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getObjectStores</span><span class="token punctuation">(</span>storeName<span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token builtin">Promise</span></span><span class="token punctuation">(</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span>reject<span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
      <span class="token keyword">const</span> request<span class="token operator">=</span>objectStores<span class="token punctuation">.</span><span class="token function">openCursor</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span>
      <span class="token comment">//创建数组保存数据</span>
      <span class="token keyword">let</span> list<span class="token operator">:</span><span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      request<span class="token punctuation">.</span><span class="token function-variable function">onerror</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token function">reject</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>
      request<span class="token punctuation">.</span><span class="token function-variable function">onsuccess</span><span class="token operator">=</span><span class="token punctuation">(</span>ev<span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        <span class="token keyword">let</span> cursor<span class="token operator">=</span>ev<span class="token punctuation">.</span>target<span class="token operator">?.</span>result
        <span class="token keyword">if</span><span class="token punctuation">(</span>cursor<span class="token punctuation">)</span><span class="token punctuation">{</span>
          list<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>cursor<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
          <span class="token comment">//遍历</span>
          cursor<span class="token punctuation">.</span><span class="token function">continue</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
          <span class="token function">resolve</span><span class="token punctuation">(</span>list<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token comment">/**
   * @async
   * @param storeName 仓库名
   * @param indexName 索引名
   * @param indexValue 索引值
   * @returns Promise&lt;boolean|object&gt;
   * @description 通过索引查找
   */</span>
  <span class="token keyword">public</span> <span class="token keyword">async</span> <span class="token function">getByIndex</span><span class="token punctuation">(</span>storeName<span class="token operator">:</span><span class="token builtin">string</span><span class="token punctuation">,</span>indexName<span class="token operator">:</span><span class="token builtin">string</span><span class="token punctuation">,</span>indexValue<span class="token operator">:</span><span class="token builtin">any</span><span class="token punctuation">)</span><span class="token operator">:</span><span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token builtin">boolean</span><span class="token operator">|</span>object<span class="token operator">&gt;</span><span class="token punctuation">{</span>
    <span class="token keyword">const</span> objectStores<span class="token operator">:</span>IDBObjectStore<span class="token operator">=</span><span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getObjectStores</span><span class="token punctuation">(</span>storeName<span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token builtin">Promise</span></span><span class="token punctuation">(</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span>reject<span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
      <span class="token keyword">const</span> request<span class="token operator">=</span>objectStores<span class="token punctuation">.</span><span class="token function">index</span><span class="token punctuation">(</span>indexName<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>indexValue<span class="token punctuation">)</span>
      request<span class="token punctuation">.</span><span class="token function-variable function">onerror</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token function">reject</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>
      request<span class="token punctuation">.</span><span class="token function-variable function">onsuccess</span><span class="token operator">=</span><span class="token punctuation">(</span>ev<span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token function">resolve</span><span class="token punctuation">(</span>ev<span class="token punctuation">.</span>target<span class="token operator">?.</span>result<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  
  <span class="token comment">/**
   * @async
   * @param storeName 仓库名
   * @param indexName 索引名
   * @param indexValue 索引值
   * @param count 数目
   * @returns Promise&lt;boolean|object&gt;
   * @description 通过索引查找指定条数的记录
   */</span>
  <span class="token keyword">public</span> <span class="token keyword">async</span> <span class="token function">findByIndex</span><span class="token punctuation">(</span>storeName<span class="token operator">:</span><span class="token builtin">string</span><span class="token punctuation">,</span>indexName<span class="token operator">:</span><span class="token builtin">string</span><span class="token punctuation">,</span>indexValue<span class="token operator">:</span><span class="token builtin">any</span><span class="token punctuation">,</span>count<span class="token operator">?</span><span class="token operator">:</span><span class="token builtin">number</span><span class="token punctuation">)</span><span class="token operator">:</span><span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token builtin">boolean</span><span class="token operator">|</span>object<span class="token operator">&gt;</span><span class="token punctuation">{</span>
    <span class="token keyword">const</span> objectStores<span class="token operator">:</span>IDBObjectStore<span class="token operator">=</span><span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getObjectStores</span><span class="token punctuation">(</span>storeName<span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token builtin">Promise</span></span><span class="token punctuation">(</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span>reject<span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
      <span class="token keyword">const</span> request<span class="token operator">=</span>objectStores<span class="token punctuation">.</span><span class="token function">index</span><span class="token punctuation">(</span>indexName<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getAll</span><span class="token punctuation">(</span>indexValue<span class="token punctuation">,</span>count<span class="token punctuation">)</span>
      request<span class="token punctuation">.</span><span class="token function-variable function">onerror</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token function">reject</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>
      request<span class="token punctuation">.</span><span class="token function-variable function">onsuccess</span><span class="token operator">=</span><span class="token punctuation">(</span>ev<span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token function">resolve</span><span class="token punctuation">(</span>ev<span class="token punctuation">.</span>target<span class="token operator">?.</span>result<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token comment">/**
   * @async
   * @param storeName 仓库名
   * @param indexName 索引名
   * @param indexValue 索引值
   * @returns Promise&lt;boolean|object[]&gt;
   * @description 通过索引及游标查询,查询全部符合条件的数据
   */</span>
  <span class="token keyword">public</span> <span class="token keyword">async</span> <span class="token function">getByIndexCursor</span><span class="token punctuation">(</span>storeName<span class="token operator">:</span><span class="token builtin">string</span><span class="token punctuation">,</span>indexName<span class="token operator">:</span><span class="token builtin">string</span><span class="token punctuation">,</span>indexValue<span class="token operator">:</span><span class="token builtin">any</span><span class="token punctuation">)</span><span class="token operator">:</span><span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token builtin">boolean</span><span class="token operator">|</span>object<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token punctuation">{</span>
    <span class="token keyword">const</span> objectStore<span class="token operator">:</span>IDBObjectStore<span class="token operator">=</span><span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getObjectStores</span><span class="token punctuation">(</span>storeName<span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token builtin">Promise</span></span><span class="token punctuation">(</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span>reject<span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
      <span class="token keyword">const</span> request<span class="token operator">=</span>objectStore<span class="token punctuation">.</span><span class="token function">index</span><span class="token punctuation">(</span>indexName<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">openCursor</span><span class="token punctuation">(</span>IDBKeyRange<span class="token punctuation">.</span><span class="token function">only</span><span class="token punctuation">(</span>indexValue<span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token keyword">const</span> list<span class="token operator">:</span><span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      request<span class="token punctuation">.</span><span class="token function-variable function">onerror</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token function">reject</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>
      request<span class="token punctuation">.</span><span class="token function-variable function">onsuccess</span><span class="token operator">=</span><span class="token punctuation">(</span>ev<span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        <span class="token keyword">let</span> cursor<span class="token operator">:</span>IDBCursor<span class="token operator">=</span>ev<span class="token punctuation">.</span>target<span class="token operator">?.</span>result<span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>cursor<span class="token punctuation">)</span><span class="token punctuation">{</span>
          list<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>cursor<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
          cursor<span class="token punctuation">.</span><span class="token function">continue</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
          <span class="token function">resolve</span><span class="token punctuation">(</span>list<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>


  <span class="token comment">/**
   * @async
   * @param storeName 仓库名
   * @param indexName 索引名
   * @param indexValue 索引值
   * @param page 页码
   * @param pageSize 当前页数目
   * @returns Promise&lt;boolean|object[]&gt;
   * @description 分页查找
   */</span>
  <span class="token keyword">public</span> <span class="token keyword">async</span> <span class="token function">PageByIndexCursor</span><span class="token punctuation">(</span>storeName<span class="token operator">:</span><span class="token builtin">string</span><span class="token punctuation">,</span>indexName<span class="token operator">:</span><span class="token builtin">string</span><span class="token punctuation">,</span>indexValue<span class="token operator">:</span><span class="token builtin">any</span><span class="token punctuation">,</span>page<span class="token operator">:</span><span class="token builtin">number</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>pageSize<span class="token operator">:</span><span class="token builtin">number</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">:</span><span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token builtin">boolean</span><span class="token operator">|</span>object<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token punctuation">{</span>
    <span class="token keyword">const</span> objectStore<span class="token operator">:</span>IDBObjectStore<span class="token operator">=</span><span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getObjectStores</span><span class="token punctuation">(</span>storeName<span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token builtin">Promise</span></span><span class="token punctuation">(</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span>reject<span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
      <span class="token keyword">const</span> request<span class="token operator">=</span>objectStore<span class="token punctuation">.</span><span class="token function">index</span><span class="token punctuation">(</span>indexName<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">openCursor</span><span class="token punctuation">(</span>IDBKeyRange<span class="token punctuation">.</span><span class="token function">only</span><span class="token punctuation">(</span>indexValue<span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token keyword">const</span> list<span class="token operator">:</span><span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword">let</span> counter<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
      <span class="token keyword">let</span> advanced<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">;</span>
      request<span class="token punctuation">.</span><span class="token function-variable function">onerror</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token function">reject</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>
      request<span class="token punctuation">.</span><span class="token function-variable function">onsuccess</span><span class="token operator">=</span><span class="token punctuation">(</span>ev<span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        <span class="token keyword">let</span> cursor<span class="token operator">:</span>IDBCursor<span class="token operator">|</span><span class="token keyword">null</span><span class="token operator">=</span>ev<span class="token punctuation">.</span>target<span class="token operator">?.</span>result<span class="token punctuation">;</span>
        <span class="token comment">//判断是否需要跳过</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>page<span class="token operator">&gt;</span><span class="token number">1</span> <span class="token operator">&amp;&amp;</span> advanced<span class="token punctuation">)</span><span class="token punctuation">{</span>
          advanced<span class="token operator">=</span><span class="token boolean">false</span><span class="token punctuation">;</span>
          <span class="token comment">//前进多少条</span>
          cursor<span class="token operator">!</span><span class="token punctuation">.</span><span class="token function">advance</span><span class="token punctuation">(</span><span class="token punctuation">(</span>page<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span>pageSize<span class="token punctuation">)</span>
          <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>cursor<span class="token punctuation">)</span><span class="token punctuation">{</span>
          list<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>cursor<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
          counter<span class="token operator">++</span><span class="token punctuation">;</span>

          <span class="token keyword">if</span><span class="token punctuation">(</span>counter<span class="token operator">&lt;</span>pageSize<span class="token punctuation">)</span><span class="token punctuation">{</span>
            cursor<span class="token punctuation">.</span><span class="token function">continue</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
          <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
            cursor<span class="token operator">=</span><span class="token keyword">null</span>
            <span class="token function">resolve</span><span class="token punctuation">(</span>list<span class="token punctuation">)</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
          <span class="token function">resolve</span><span class="token punctuation">(</span>list<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  
  <span class="token comment">/**
   * @async
   * @param storeName 仓库名
   * @param page 页码
   * @param pageSize 当前页数目
   * @returns Promise&lt;boolean|object[]&gt;
   * @description 分页查找全部数据
   */</span>
  <span class="token keyword">public</span> <span class="token keyword">async</span> <span class="token function">page</span><span class="token punctuation">(</span>storeName<span class="token operator">:</span><span class="token builtin">string</span><span class="token punctuation">,</span>page<span class="token operator">:</span><span class="token builtin">number</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>pageSize<span class="token operator">:</span><span class="token builtin">number</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">:</span><span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token builtin">boolean</span><span class="token operator">|</span>object<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token punctuation">{</span>
    <span class="token keyword">const</span> objectStore<span class="token operator">=</span><span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getObjectStores</span><span class="token punctuation">(</span>storeName<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token builtin">Promise</span></span><span class="token punctuation">(</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span>reject<span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
      <span class="token keyword">const</span> request<span class="token operator">=</span>objectStore<span class="token punctuation">.</span><span class="token function">openCursor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> list<span class="token operator">:</span><span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
      <span class="token keyword">let</span> counter<span class="token operator">:</span><span class="token builtin">number</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
      <span class="token keyword">let</span> advanced<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">;</span>
      request<span class="token punctuation">.</span><span class="token function-variable function">onerror</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token function">reject</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>
      request<span class="token punctuation">.</span><span class="token function-variable function">onsuccess</span><span class="token operator">=</span><span class="token punctuation">(</span>ev<span class="token operator">:</span><span class="token builtin">any</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        <span class="token keyword">let</span> cursor<span class="token operator">:</span>IDBCursor<span class="token operator">|</span><span class="token keyword">null</span><span class="token operator">=</span>ev<span class="token punctuation">.</span>target<span class="token punctuation">.</span>result
        <span class="token keyword">if</span><span class="token punctuation">(</span>page<span class="token operator">&gt;</span><span class="token number">1</span> <span class="token operator">&amp;&amp;</span> advanced<span class="token punctuation">)</span><span class="token punctuation">{</span>
          advanced<span class="token operator">=</span><span class="token boolean">false</span><span class="token punctuation">;</span>
          cursor<span class="token operator">?.</span><span class="token function">advance</span><span class="token punctuation">(</span><span class="token punctuation">(</span>page<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span>pageSize<span class="token punctuation">)</span>
          <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>cursor<span class="token punctuation">)</span><span class="token punctuation">{</span>
          list<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>cursor<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
          counter<span class="token operator">++</span><span class="token punctuation">;</span>
          <span class="token keyword">if</span><span class="token punctuation">(</span>counter<span class="token operator">&lt;</span>pageSize<span class="token punctuation">)</span><span class="token punctuation">{</span>
            cursor<span class="token punctuation">.</span><span class="token function">continue</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
          <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
            cursor<span class="token operator">=</span><span class="token keyword">null</span><span class="token punctuation">;</span>
            <span class="token function">resolve</span><span class="token punctuation">(</span>list<span class="token punctuation">)</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
          <span class="token function">resolve</span><span class="token punctuation">(</span>list<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token comment">/**
   * @async
   * @param storeName 仓库名
   * @param data 数据对象 注意：一定要包含主键
   * @returns Promise&lt;boolean&gt;
   * @description 通过主键更新数据，数据对象中一定要包含主键
   */</span>
  <span class="token keyword">public</span> <span class="token keyword">async</span> <span class="token function">put</span><span class="token punctuation">(</span>storeName<span class="token operator">:</span><span class="token builtin">string</span><span class="token punctuation">,</span>data<span class="token operator">:</span><span class="token builtin">any</span><span class="token punctuation">)</span><span class="token operator">:</span><span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token builtin">boolean</span><span class="token operator">&gt;</span><span class="token punctuation">{</span>
    <span class="token keyword">const</span> objectStore<span class="token operator">=</span><span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getObjectStores</span><span class="token punctuation">(</span>storeName<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token builtin">Promise</span></span><span class="token punctuation">(</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span>reject<span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
      <span class="token keyword">const</span> request<span class="token operator">=</span>objectStore<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
      request<span class="token punctuation">.</span><span class="token function-variable function">onerror</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token function">reject</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>
      request<span class="token punctuation">.</span><span class="token function-variable function">onsuccess</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  
  <span class="token comment">/**
   * @async
   * @param storeName 仓库名
   * @param indexName 索引名
   * @param indexValue 索引值
   * @param data 数据对象，建议不包含主键
   * @param updateAll 是否更新所有匹配
   * @returns Promise&lt;boolean&gt;
   * @description 通过索引批量更新
   */</span>
  <span class="token keyword">public</span> <span class="token keyword">async</span> <span class="token function">putByIndexCursor</span><span class="token punctuation">(</span>storeName<span class="token operator">:</span><span class="token builtin">string</span><span class="token punctuation">,</span>indexName<span class="token operator">:</span><span class="token builtin">string</span><span class="token punctuation">,</span>indexValue<span class="token operator">:</span><span class="token builtin">any</span><span class="token punctuation">,</span>data<span class="token operator">:</span><span class="token builtin">any</span><span class="token punctuation">,</span>updateAll<span class="token operator">:</span><span class="token builtin">boolean</span><span class="token operator">=</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token operator">:</span><span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token builtin">boolean</span><span class="token operator">&gt;</span><span class="token punctuation">{</span>
    <span class="token keyword">const</span> objectStore<span class="token operator">=</span><span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getObjectStores</span><span class="token punctuation">(</span>storeName<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token builtin">Promise</span></span><span class="token punctuation">(</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span>reject<span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
      <span class="token keyword">const</span> request<span class="token operator">=</span>objectStore<span class="token punctuation">.</span><span class="token function">index</span><span class="token punctuation">(</span>indexName<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">openCursor</span><span class="token punctuation">(</span>IDBKeyRange<span class="token punctuation">.</span><span class="token function">only</span><span class="token punctuation">(</span>indexValue<span class="token punctuation">)</span><span class="token punctuation">)</span>
      request<span class="token punctuation">.</span><span class="token function-variable function">onerror</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token function">reject</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>
      request<span class="token punctuation">.</span><span class="token function-variable function">onsuccess</span><span class="token operator">=</span><span class="token punctuation">(</span>ev<span class="token operator">:</span> <span class="token punctuation">{</span> target<span class="token operator">:</span> <span class="token punctuation">{</span> result<span class="token operator">:</span> IDBCursor <span class="token operator">|</span> <span class="token keyword">null</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        <span class="token keyword">const</span> cursor<span class="token operator">:</span>IDBCursor<span class="token operator">|</span><span class="token keyword">null</span><span class="token operator">=</span>ev<span class="token punctuation">.</span>target<span class="token punctuation">.</span>result<span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>cursor<span class="token punctuation">)</span><span class="token punctuation">{</span>
          <span class="token comment">//保存旧值</span>
          <span class="token keyword">let</span> Value<span class="token operator">=</span>cursor<span class="token punctuation">.</span>value
          <span class="token keyword">let</span> keys<span class="token operator">=</span>Object<span class="token punctuation">.</span><span class="token function">getOwnPropertyNames</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
          <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> key <span class="token keyword">in</span> Value<span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>keys<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
              Value<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token operator">=</span>data<span class="token punctuation">[</span>key<span class="token punctuation">]</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">}</span>
          <span class="token keyword">const</span> updateRequest<span class="token operator">=</span>cursor<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>Value<span class="token punctuation">)</span>
          updateRequest<span class="token punctuation">.</span><span class="token function-variable function">onerror</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
            <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'单个更新失败'</span><span class="token punctuation">)</span>
          <span class="token punctuation">}</span>
          <span class="token keyword">if</span><span class="token punctuation">(</span>updateAll<span class="token punctuation">)</span><span class="token punctuation">{</span>
            cursor<span class="token punctuation">.</span><span class="token function">continue</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
          <span class="token punctuation">}</span>
          
        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
          <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token comment">/**
   * @async
   * @param storeName 仓库名
   * @param key 主键值
   * @returns Promise&lt;boolean&gt;
   * @description 通过主键删除
   */</span>
  <span class="token keyword">public</span> <span class="token keyword">async</span> <span class="token keyword">delete</span><span class="token punctuation">(</span>storeName<span class="token operator">:</span><span class="token builtin">string</span><span class="token punctuation">,</span>key<span class="token operator">:</span><span class="token builtin">any</span><span class="token punctuation">)</span><span class="token operator">:</span><span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token builtin">boolean</span><span class="token operator">&gt;</span><span class="token punctuation">{</span>
    <span class="token keyword">const</span> objectStore<span class="token operator">:</span>IDBObjectStore<span class="token operator">=</span><span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getObjectStores</span><span class="token punctuation">(</span>storeName<span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token builtin">Promise</span></span><span class="token punctuation">(</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span>reject<span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
      <span class="token keyword">const</span> request<span class="token operator">=</span>objectStore<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span>
      request<span class="token punctuation">.</span><span class="token function-variable function">onerror</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token function">reject</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>
      request<span class="token punctuation">.</span><span class="token function-variable function">onsuccess</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token comment">/**
   * @async
   * @param storeName 仓库名
   * @param indexName 索引名
   * @param indexValue 索引值
   * @param deleteAll 是否删除全部，默认false
   * @returns Promise&lt;boolean&gt;
   * @description 通过索引删除数据，默认删除匹配的第一条
   */</span>
  <span class="token keyword">public</span> <span class="token keyword">async</span> <span class="token function">deleteByIndex</span><span class="token punctuation">(</span>storeName<span class="token operator">:</span><span class="token builtin">string</span><span class="token punctuation">,</span>indexName<span class="token operator">:</span><span class="token builtin">string</span><span class="token punctuation">,</span>indexValue<span class="token operator">:</span><span class="token builtin">any</span><span class="token punctuation">,</span>deleteAll<span class="token operator">:</span><span class="token builtin">boolean</span><span class="token operator">=</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token operator">:</span><span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token builtin">boolean</span><span class="token operator">&gt;</span><span class="token punctuation">{</span>
    <span class="token keyword">const</span> objectStore<span class="token operator">:</span>IDBObjectStore<span class="token operator">=</span><span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getObjectStores</span><span class="token punctuation">(</span>storeName<span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token builtin">Promise</span></span><span class="token punctuation">(</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span>reject<span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
      <span class="token keyword">const</span> request<span class="token operator">=</span>objectStore<span class="token punctuation">.</span><span class="token function">index</span><span class="token punctuation">(</span>indexName<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">openCursor</span><span class="token punctuation">(</span>IDBKeyRange<span class="token punctuation">.</span><span class="token function">only</span><span class="token punctuation">(</span>indexValue<span class="token punctuation">)</span><span class="token punctuation">)</span>
      request<span class="token punctuation">.</span><span class="token function-variable function">onerror</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token function">reject</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>
      request<span class="token punctuation">.</span><span class="token function-variable function">onsuccess</span><span class="token operator">=</span><span class="token punctuation">(</span>ev<span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        <span class="token keyword">let</span> cursor<span class="token operator">:</span>IDBCursor<span class="token operator">|</span><span class="token keyword">null</span><span class="token operator">=</span>ev<span class="token punctuation">.</span>target<span class="token operator">?.</span>result
        <span class="token keyword">if</span><span class="token punctuation">(</span>cursor<span class="token punctuation">)</span><span class="token punctuation">{</span>
          <span class="token keyword">const</span> deleteRequest<span class="token operator">=</span>cursor<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
          <span class="token keyword">if</span><span class="token punctuation">(</span>deleteAll<span class="token punctuation">)</span><span class="token punctuation">{</span>
            cursor<span class="token punctuation">.</span><span class="token function">continue</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
          <span class="token punctuation">}</span>
          deleteRequest<span class="token punctuation">.</span><span class="token function-variable function">onerror</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
            <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'删除单个失败'</span><span class="token punctuation">)</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
          <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token comment">/**
   * @description 关闭数据库
   */</span>
  <span class="token keyword">public</span> <span class="token keyword">async</span> <span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">const</span> db<span class="token operator">=</span><span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getDb</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    db<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'数据库已关闭'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token comment">/**
   * @async
   * @returns Promise&lt;boolean&gt;
   * @description 删库跑路
   */</span>
  <span class="token keyword">public</span> <span class="token keyword">async</span> <span class="token function">deleteDb</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span><span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token builtin">boolean</span><span class="token operator">&gt;</span><span class="token punctuation">{</span>
    <span class="token keyword">const</span> deleteRequest<span class="token operator">=</span>window<span class="token punctuation">.</span>indexedDB<span class="token punctuation">.</span><span class="token function">deleteDatabase</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>o<span class="token punctuation">.</span>databaseName<span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token builtin">Promise</span></span><span class="token punctuation">(</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span>reject<span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
      deleteRequest<span class="token punctuation">.</span><span class="token function-variable function">onerror</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token function">reject</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>
      deleteRequest<span class="token punctuation">.</span><span class="token function-variable function">onsuccess</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>o<span class="token punctuation">.</span>databaseName<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">数据库删除成功</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
        <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><h2 id="四-有啥好的建议-欢迎评论-回复加关注"><a href="#四-有啥好的建议-欢迎评论-回复加关注" class="header-anchor">#</a> 四.有啥好的建议，欢迎评论，回复加关注</h2></div> <footer class="page-edit" style="display:none;"><!----> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">2022/6/14 11:55:22</span></div></footer> <!----> <!----> <!----></main> <!----></div></div></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-c6073ba8 data-v-c6073ba8><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-c6073ba8><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-c6073ba8></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-c6073ba8></path></svg></div><!----><div class="RibbonAnimation"></div></div></div>
    <script src="/assets/js/app.263edb86.js" defer></script><script src="/assets/js/5.41e71567.js" defer></script><script src="/assets/js/1.0885ffa2.js" defer></script><script src="/assets/js/20.98d10011.js" defer></script>
  </body>
</html>
